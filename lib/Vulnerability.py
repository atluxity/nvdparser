from lib.Product import Product

class Vulnerability(object):
    def __init__(self, vulnerability=None):
        self.cve_id = None
        self.publish_date = None
        self.update_date = None
        self.summary = None
        self.cvss = None
        self.vector = None
        self.product = []
        self.url = None

        if vulnerability:
            if "vulnerability" in vulnerability:
                vulnerability = vulnerability['vulnerability']

            if "cve_id" in vulnerability:
                self.cve_id = vulnerability['cve_id']
            if "publish_date" in vulnerability:
                self.publish_date = vulnerability['publish_date']
            if "update_date" in vulnerability:
                self.update_date = vulnerability['update_date']
            if "summary" in vulnerability:
                self.summary = vulnerability['summary'].strip()
            if "cvss" in vulnerability:
                self.cvss = vulnerability['cvss']
            if "vector" in vulnerability:
                self.vector = vulnerability['vector']
            if "product" in vulnerability:
                self.product = vulnerability['product']
